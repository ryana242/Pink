{"ast":null,"code":"var _jsxFileName = \"H:\\\\3-2\\\\pink\\\\Pink\\\\frontend\\\\src\\\\Components\\\\editComplain.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Modal } from \"bootstrap\";\nimport axios from \"axios\";\nimport AsyncSelect from \"react-select/async\";\nimport { useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction EditComplaint() {\n  _s();\n\n  const [selectedFiles, setSelectedFiles] = useState([]);\n  const [isFilePicked, setIsFilePicked] = useState(false);\n  const [openCompAgainstMenu, setOpenCompAgainstMenu] = useState(false);\n  const [openCompReviewerMenu, setOpenCompReviewerMenu] = useState(false);\n  const [complainTitle, setComplainTitle] = useState(\"\");\n  const [complainDescription, setComplainDescription] = useState(\"\");\n  const [complainAgainst, setComplainAgainst] = useState([]);\n  const [reviewer, setReviewer] = useState(\"\");\n  const [complainDescriptionErrorClass, setComplainDescriptionErrorClass] = useState(\"none\");\n  const [complainAgainstErrorClass, setComplainAgainstErrorClass] = useState(\"none\");\n  const [evidenceErrorClass, setEvidenceErrorClass] = useState(\"none\");\n  const token = localStorage.getItem(\"userUNID\");\n  const {\n    id\n  } = useParams();\n  const [complainAgainstOptions, setComplainAgainstOptions] = useState([]);\n  const [reviewerOption, setReviewerOption] = useState({});\n  const [oldEvidence, setOldEvidence] = useState([]);\n  const max = 250;\n\n  if (!token) {\n    window.location.replace(\"http://localhost:3000/login\");\n  }\n\n  useEffect(() => {\n    async function fetchData() {\n      let response = await axios.get(\"http://localhost:8000/home/complain-latest-details\", {\n        params: {\n          complainUNID: id\n        }\n      });\n\n      if (token != response.data.data.ComplainerUNID) {\n        window.location.replace(\"http://localhost:3000\");\n      }\n\n      if (response.data.error || response.data.data == null) {\n        window.location.replace(\"http://localhost:3000\");\n      }\n\n      setComplainTitle(response.data.data.complainTitle);\n      setComplainDescription(response.data.data.ComplainDescriptions[0].complainDescription);\n      let temp = {\n        label: response.data.data.ComplainReviewers[0].User.uniqueDetail,\n        value: response.data.data.ComplainReviewers[0].User.userUNID\n      };\n      const temp1 = response.data.data.ComplainAgainsts.map(e => ({\n        label: e.User.uniqueDetail,\n        value: e.User.userUNID\n      }));\n      const temp2 = response.data.data.ComplainAgainsts.map(e => e.User.userUNID);\n      setComplainAgainst(temp2);\n      setComplainAgainstOptions(temp1);\n      setReviewerOption(temp);\n      setReviewer(response.data.data.ComplainReviewers[0].User.userUNID);\n      setOldEvidence(response.data.data.Evidence.map(e => e.evidence));\n    }\n\n    fetchData();\n  }, []);\n\n  const updateList = function (e) {\n    e.preventDefault();\n    const newFiles = selectedFiles.slice();\n\n    for (let i = 0; i < e.target.files.length; i++) {\n      newFiles.push(e.target.files[i]);\n    }\n\n    if (newFiles.length > 0) {\n      setIsFilePicked(true);\n      setEvidenceErrorClass(\"none\");\n    }\n\n    setSelectedFiles(newFiles);\n    e.target.value = \"\";\n  };\n\n  const handleCrossButton = function (e, index) {\n    e.preventDefault();\n    console.log(index);\n    const newFiles = selectedFiles.slice();\n    newFiles.splice(index, 1);\n    setSelectedFiles(newFiles);\n    console.log(newFiles);\n  };\n\n  const handleComplainAgainstOnChange = e => {\n    setOpenCompAgainstMenu(false);\n    setComplainAgainstErrorClass(\"none\");\n    const temp = [];\n\n    for (let i = 0; i < e.length; i++) {\n      temp.push(e[i].value);\n    }\n\n    setComplainAgainstOptions(e);\n    setComplainAgainst(temp);\n  };\n\n  const handleReviewerOnChange = e => {\n    setOpenCompReviewerMenu(false);\n    setReviewer(e.value);\n  };\n\n  const fetchComplainAgainstData = async (input, callback) => {\n    let response = await axios.get(\"http://localhost:8000/home/complain-against\", {\n      params: {\n        query: input,\n        userUNID: token\n      }\n    });\n    callback(response.data.data.map(i => ({\n      label: i.uniqueDetail,\n      value: i.userUNID,\n      isDisabled: reviewer == i.userUNID ? true : false\n    })));\n  };\n\n  const fetchReviewerData = async (input, callback) => {\n    let response = await axios.get(\"http://localhost:8000/home/reviewers\", {\n      params: {\n        query: input,\n        userUNID: token\n      }\n    });\n    console.log(response);\n    callback(response.data.data.map(i => ({\n      label: i.uniqueDetail,\n      value: i.userUNID,\n      isDisabled: complainAgainst.some(e => e == i.userUNID ? true : false)\n    })));\n  };\n\n  async function handleLodgeComplaintButtonClicked(e) {\n    e.preventDefault();\n    console.log(complainAgainst);\n\n    if (!complainDescription || complainDescription.length > max) {\n      return setComplainDescriptionErrorClass(\"block\");\n    }\n\n    if (complainAgainst.length === 0) {\n      return setComplainAgainstErrorClass(\"block\");\n    }\n\n    const formData = new FormData();\n    formData.append(\"complainUNID\", id);\n    formData.append(\"complainerUNID\", token);\n    formData.append(\"complainTitle\", complainTitle);\n    formData.append(\"complainDescription\", complainDescription);\n    formData.append(\"complainAgainstUserUNID\", JSON.stringify(complainAgainst));\n    formData.append(\"complainReviewerUserUNID\", reviewer);\n    formData.append(\"oldEvidenceCount\", oldEvidence.length);\n    selectedFiles.forEach(file => {\n      formData.append(\"file\", file);\n    });\n    let response = await axios.post(\"http://localhost:8000/home/edit-complain\", formData, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    });\n    console.log(response);\n\n    if (response.data.data) {\n      let myModal = new Modal(document.getElementById(\"exampleModal\"));\n      myModal.show();\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"flex-grow-1 background-color d-flex align-items-center justify-content-center\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"row justify-content-center w-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"col-xl-5 col-lg-7 col-md-9 col-11 my-4 primary-background-color px-lg-5 pb-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"separator my-5 \",\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-dark fw-light\",\n            children: \"Edit Complaint\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleLodgeComplaintButtonClicked,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"form-group mb-4\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              disabled: true,\n              value: complainTitle,\n              type: \"text\",\n              class: \"form-control\",\n              id: \"emailInput\",\n              placeholder: \"Complain Title\",\n              onInput: e => {\n                setComplainTitle(e.target.value);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"form-group mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: complainDescription,\n              class: \"form-control\",\n              id: \"form4Example3\",\n              rows: \"6\",\n              placeholder: \"Complain Description (upto 150 words)\",\n              style: {\n                resize: \"none\"\n              },\n              onInput: e => {\n                setComplainDescription(e.target.value);\n              },\n              onChange: e => {\n                setComplainDescriptionErrorClass(\"none\");\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              class: \"text-danger d-\" + complainDescriptionErrorClass,\n              children: \"Enter Complaint Description within 250 words.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group d-flex flex-column mb-4\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: [/*#__PURE__*/_jsxDEV(AsyncSelect, {\n                loadOptions: fetchComplainAgainstData,\n                value: complainAgainstOptions,\n                placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: \"grey\"\n                  },\n                  children: \"Complain Against\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 21\n                }, this),\n                components: {\n                  DropdownIndicator: () => null,\n                  // Remove dropdown icon\n                  IndicatorSeparator: () => null // Remove separator\n\n                },\n                isMulti: true,\n                defaultValue: complainAgainst,\n                onChange: handleComplainAgainstOnChange,\n                onBlur: e => {\n                  setOpenCompAgainstMenu(false);\n                },\n                onInputChange: (e, _ref) => {\n                  let {\n                    action\n                  } = _ref;\n\n                  if (e.length === 0) {\n                    setOpenCompAgainstMenu(false);\n                    return;\n                  }\n\n                  if (action === \"input-change\") {\n                    setOpenCompAgainstMenu(true);\n                  }\n                },\n                menuIsOpen: openCompAgainstMenu\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                class: \"text-danger d-\" + complainAgainstErrorClass,\n                children: \"Select user(s) to complain against.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-column\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-2\",\n              children: \"Old Evidence(s)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this), oldEvidence.map((src, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-2\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"h6 fw-normal\",\n                href: \"http://localhost:8000/uploads/Evidence/\" + src,\n                target: \"_blank\",\n                download: index + 1,\n                children: [\"Evidence \", index + 1]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"form-group mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              class: \"button-attach ms-0\",\n              for: \"file\",\n              style: {\n                width: \"40%\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                class: \"bi bi-paperclip me-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 17\n              }, this), \"Add new evidence\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              accept: \"image/*, application/pdf, video/*\",\n              id: \"file\",\n              type: \"file\",\n              name: \"file\",\n              multiple: true,\n              onChange: updateList\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 15\n            }, this), isFilePicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"fileList\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                class: \"py-2 mb-0\",\n                children: selectedFiles.map((k, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                  class: \"d-flex justify-content-between align-items-center border rounded-3 border-3 border-light bg-white mt-2 ps-2\",\n                  children: [k.name, /*#__PURE__*/_jsxDEV(\"button\", {\n                    class: \"btn btn-light\",\n                    onClick: e => handleCrossButton(e, index),\n                    children: [\" \", \"x\", \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 298,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n              class: \"d-none\",\n              children: \"Select a file to show details\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              class: \"mb-2 text-danger d-\" + evidenceErrorClass,\n              children: \"Please attach evidence(s)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group d-flex flex-column mb-4\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: /*#__PURE__*/_jsxDEV(AsyncSelect, {\n                loadOptions: fetchReviewerData,\n                isDisabled: true,\n                value: reviewerOption,\n                placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: \"grey\"\n                  },\n                  children: \"Choose Reviewer(only one)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 21\n                }, this),\n                components: {\n                  DropdownIndicator: () => null,\n                  // Remove dropdown icon\n                  IndicatorSeparator: () => null // Remove separator\n\n                },\n                onChange: handleReviewerOnChange,\n                onBlur: e => {\n                  setOpenCompReviewerMenu(false);\n                },\n                onInputChange: (e, _ref2) => {\n                  let {\n                    action\n                  } = _ref2;\n\n                  if (e.length === 0) {\n                    setOpenCompReviewerMenu(false);\n                    return;\n                  }\n\n                  if (action === \"input-change\") {\n                    setOpenCompReviewerMenu(true);\n                  }\n                },\n                menuIsOpen: openCompReviewerMenu\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-block\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              class: \"btn btn-primary w-100 fw-bold\",\n              children: \"Edit Complaint\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"modal fade\",\n          \"data-bs-backdrop\": \"static\",\n          \"data-bs-keyboard\": \"false\",\n          id: \"exampleModal\",\n          tabindex: \"-1\",\n          \"aria-labelledby\": \"exampleModalLabel\",\n          \"aria-hidden\": \"true\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"modal-dialog modal-dialog-centered\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"modal-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-header\",\n                children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                  class: \"modal-title\",\n                  id: \"exampleModalLabel\",\n                  children: \"Complaint Edited Successfully!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  class: \"btn-close\",\n                  \"data-bs-dismiss\": \"modal\",\n                  \"aria-label\": \"Close\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-body\",\n                children: \"Click OK to continue\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-footer\",\n                children: /*#__PURE__*/_jsxDEV(\"a\", {\n                  className: \"btn btn-primary\",\n                  href: \"/\",\n                  children: \"OK\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 378,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 187,\n    columnNumber: 5\n  }, this);\n}\n\n_s(EditComplaint, \"BcBKpXJma7P8lGTZk5OvRVWfvgM=\", false, function () {\n  return [useParams];\n});\n\n_c = EditComplaint;\nexport default EditComplaint;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditComplaint\");","map":{"version":3,"sources":["H:/3-2/pink/Pink/frontend/src/Components/editComplain.jsx"],"names":["React","useState","useEffect","Modal","axios","AsyncSelect","useParams","EditComplaint","selectedFiles","setSelectedFiles","isFilePicked","setIsFilePicked","openCompAgainstMenu","setOpenCompAgainstMenu","openCompReviewerMenu","setOpenCompReviewerMenu","complainTitle","setComplainTitle","complainDescription","setComplainDescription","complainAgainst","setComplainAgainst","reviewer","setReviewer","complainDescriptionErrorClass","setComplainDescriptionErrorClass","complainAgainstErrorClass","setComplainAgainstErrorClass","evidenceErrorClass","setEvidenceErrorClass","token","localStorage","getItem","id","complainAgainstOptions","setComplainAgainstOptions","reviewerOption","setReviewerOption","oldEvidence","setOldEvidence","max","window","location","replace","fetchData","response","get","params","complainUNID","data","ComplainerUNID","error","ComplainDescriptions","temp","label","ComplainReviewers","User","uniqueDetail","value","userUNID","temp1","ComplainAgainsts","map","e","temp2","Evidence","evidence","updateList","preventDefault","newFiles","slice","i","target","files","length","push","handleCrossButton","index","console","log","splice","handleComplainAgainstOnChange","handleReviewerOnChange","fetchComplainAgainstData","input","callback","query","isDisabled","fetchReviewerData","some","handleLodgeComplaintButtonClicked","formData","FormData","append","JSON","stringify","forEach","file","post","headers","myModal","document","getElementById","show","resize","color","DropdownIndicator","IndicatorSeparator","action","src","width","k","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Modal } from \"bootstrap\";\r\nimport axios from \"axios\";\r\nimport AsyncSelect from \"react-select/async\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nfunction EditComplaint() {\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [isFilePicked, setIsFilePicked] = useState(false);\r\n  const [openCompAgainstMenu, setOpenCompAgainstMenu] = useState(false);\r\n  const [openCompReviewerMenu, setOpenCompReviewerMenu] = useState(false);\r\n  const [complainTitle, setComplainTitle] = useState(\"\");\r\n  const [complainDescription, setComplainDescription] = useState(\"\");\r\n  const [complainAgainst, setComplainAgainst] = useState([]);\r\n  const [reviewer, setReviewer] = useState(\"\");\r\n  const [complainDescriptionErrorClass, setComplainDescriptionErrorClass] =\r\n    useState(\"none\");\r\n  const [complainAgainstErrorClass, setComplainAgainstErrorClass] =\r\n    useState(\"none\");\r\n  const [evidenceErrorClass, setEvidenceErrorClass] = useState(\"none\");\r\n  const token = localStorage.getItem(\"userUNID\");\r\n  const { id } = useParams();\r\n\r\n  const [complainAgainstOptions, setComplainAgainstOptions] = useState([]);\r\n  const [reviewerOption, setReviewerOption] = useState({});\r\n  const [oldEvidence, setOldEvidence] = useState([]);\r\n  const max = 250;\r\n\r\n  if (!token) {\r\n    window.location.replace(\"http://localhost:3000/login\");\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      let response = await axios.get(\r\n        \"http://localhost:8000/home/complain-latest-details\",\r\n        {\r\n          params: {\r\n            complainUNID: id,\r\n          },\r\n        }\r\n      );\r\n      if (token != response.data.data.ComplainerUNID) {\r\n        window.location.replace(\"http://localhost:3000\");\r\n      }\r\n      if (response.data.error || response.data.data == null) {\r\n        window.location.replace(\"http://localhost:3000\");\r\n      }\r\n      setComplainTitle(response.data.data.complainTitle);\r\n      setComplainDescription(\r\n        response.data.data.ComplainDescriptions[0].complainDescription\r\n      );\r\n      let temp = {\r\n        label: response.data.data.ComplainReviewers[0].User.uniqueDetail,\r\n        value: response.data.data.ComplainReviewers[0].User.userUNID,\r\n      };\r\n      const temp1 = response.data.data.ComplainAgainsts.map((e) => ({\r\n        label: e.User.uniqueDetail,\r\n        value: e.User.userUNID,\r\n      }));\r\n      const temp2 = response.data.data.ComplainAgainsts.map(\r\n        (e) => e.User.userUNID\r\n      );\r\n      setComplainAgainst(temp2);\r\n      setComplainAgainstOptions(temp1);\r\n      setReviewerOption(temp);\r\n      setReviewer(response.data.data.ComplainReviewers[0].User.userUNID);\r\n      setOldEvidence(response.data.data.Evidence.map((e) => e.evidence));\r\n    }\r\n    fetchData();\r\n  }, []);\r\n\r\n  const updateList = function (e) {\r\n    e.preventDefault();\r\n    const newFiles = selectedFiles.slice();\r\n    for (let i = 0; i < e.target.files.length; i++) {\r\n      newFiles.push(e.target.files[i]);\r\n    }\r\n    if (newFiles.length > 0) {\r\n      setIsFilePicked(true);\r\n      setEvidenceErrorClass(\"none\");\r\n    }\r\n    setSelectedFiles(newFiles);\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const handleCrossButton = function (e, index) {\r\n    e.preventDefault();\r\n    console.log(index);\r\n    const newFiles = selectedFiles.slice();\r\n    newFiles.splice(index, 1);\r\n    setSelectedFiles(newFiles);\r\n    console.log(newFiles);\r\n  };\r\n\r\n  const handleComplainAgainstOnChange = (e) => {\r\n    setOpenCompAgainstMenu(false);\r\n    setComplainAgainstErrorClass(\"none\");\r\n    const temp = [];\r\n    for (let i = 0; i < e.length; i++) {\r\n      temp.push(e[i].value);\r\n    }\r\n    setComplainAgainstOptions(e);\r\n    setComplainAgainst(temp);\r\n  };\r\n\r\n  const handleReviewerOnChange = (e) => {\r\n    setOpenCompReviewerMenu(false);\r\n    setReviewer(e.value);\r\n  };\r\n\r\n  const fetchComplainAgainstData = async (input, callback) => {\r\n    let response = await axios.get(\r\n      \"http://localhost:8000/home/complain-against\",\r\n      {\r\n        params: {\r\n          query: input,\r\n          userUNID: token,\r\n        },\r\n      }\r\n    );\r\n    callback(\r\n      response.data.data.map((i) => ({\r\n        label: i.uniqueDetail,\r\n        value: i.userUNID,\r\n        isDisabled: reviewer == i.userUNID ? true : false,\r\n      }))\r\n    );\r\n  };\r\n\r\n  const fetchReviewerData = async (input, callback) => {\r\n    let response = await axios.get(\"http://localhost:8000/home/reviewers\", {\r\n      params: {\r\n        query: input,\r\n        userUNID: token,\r\n      },\r\n    });\r\n    console.log(response);\r\n    callback(\r\n      response.data.data.map((i) => ({\r\n        label: i.uniqueDetail,\r\n        value: i.userUNID,\r\n        isDisabled: complainAgainst.some((e) =>\r\n          e == i.userUNID ? true : false\r\n        ),\r\n      }))\r\n    );\r\n  };\r\n\r\n  async function handleLodgeComplaintButtonClicked(e) {\r\n    e.preventDefault();\r\n    console.log(complainAgainst);\r\n    if (!complainDescription || complainDescription.length > max) {\r\n      return setComplainDescriptionErrorClass(\"block\");\r\n    }\r\n    if (complainAgainst.length === 0) {\r\n      return setComplainAgainstErrorClass(\"block\");\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"complainUNID\", id);\r\n    formData.append(\"complainerUNID\", token);\r\n    formData.append(\"complainTitle\", complainTitle);\r\n    formData.append(\"complainDescription\", complainDescription);\r\n    formData.append(\"complainAgainstUserUNID\", JSON.stringify(complainAgainst));\r\n    formData.append(\"complainReviewerUserUNID\", reviewer);\r\n    formData.append(\"oldEvidenceCount\", oldEvidence.length);\r\n    selectedFiles.forEach((file) => {\r\n      formData.append(\"file\", file);\r\n    });\r\n\r\n    let response = await axios.post(\r\n      \"http://localhost:8000/home/edit-complain\",\r\n      formData,\r\n      {\r\n        headers: { \"Content-Type\": \"multipart/form-data\" },\r\n      }\r\n    );\r\n    console.log(response);\r\n    if (response.data.data) {\r\n      let myModal = new Modal(document.getElementById(\"exampleModal\"));\r\n      myModal.show();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div class=\"flex-grow-1 background-color d-flex align-items-center justify-content-center\">\r\n      <div class=\"row justify-content-center w-100\">\r\n        <div class=\"col-xl-5 col-lg-7 col-md-9 col-11 my-4 primary-background-color px-lg-5 pb-5\">\r\n          <div class=\"separator my-5 \">\r\n            <h1 className=\"text-dark fw-light\">Edit Complaint</h1>\r\n          </div>\r\n          <form onSubmit={handleLodgeComplaintButtonClicked}>\r\n            <div class=\"form-group mb-4\">\r\n              <input\r\n                disabled\r\n                value={complainTitle}\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"emailInput\"\r\n                placeholder=\"Complain Title\"\r\n                onInput={(e) => {\r\n                  setComplainTitle(e.target.value);\r\n                }}\r\n              ></input>\r\n            </div>\r\n            <div class=\"form-group mb-4\">\r\n              <textarea\r\n                value={complainDescription}\r\n                class=\"form-control\"\r\n                id=\"form4Example3\"\r\n                rows=\"6\"\r\n                placeholder=\"Complain Description (upto 150 words)\"\r\n                style={{ resize: \"none\" }}\r\n                onInput={(e) => {\r\n                  setComplainDescription(e.target.value);\r\n                }}\r\n                onChange={(e) => {\r\n                  setComplainDescriptionErrorClass(\"none\");\r\n                }}\r\n              ></textarea>\r\n              <span class={\"text-danger d-\" + complainDescriptionErrorClass}>\r\n                Enter Complaint Description within 250 words.\r\n              </span>\r\n            </div>\r\n            <div className=\"form-group d-flex flex-column mb-4\">\r\n              <div className=\"col-12\">\r\n                <AsyncSelect\r\n                  loadOptions={fetchComplainAgainstData}\r\n                  value={complainAgainstOptions}\r\n                  placeholder={\r\n                    <div style={{ color: \"grey\" }}>Complain Against</div>\r\n                  }\r\n                  components={{\r\n                    DropdownIndicator: () => null, // Remove dropdown icon\r\n                    IndicatorSeparator: () => null, // Remove separator\r\n                  }}\r\n                  isMulti\r\n                  defaultValue={complainAgainst}\r\n                  onChange={handleComplainAgainstOnChange}\r\n                  onBlur={(e) => {\r\n                    setOpenCompAgainstMenu(false);\r\n                  }}\r\n                  onInputChange={(e, { action }) => {\r\n                    if (e.length === 0) {\r\n                      setOpenCompAgainstMenu(false);\r\n                      return;\r\n                    }\r\n                    if (action === \"input-change\") {\r\n                      setOpenCompAgainstMenu(true);\r\n                    }\r\n                  }}\r\n                  menuIsOpen={openCompAgainstMenu}\r\n                />\r\n                <span class={\"text-danger d-\" + complainAgainstErrorClass}>\r\n                  Select user(s) to complain against.\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"d-flex flex-column\">\r\n              <div className=\"mb-2\">Old Evidence(s)</div>\r\n              {oldEvidence.map((src, index) => (\r\n                <div className=\"mb-2\">\r\n                  <a\r\n                    className=\"h6 fw-normal\"\r\n                    href={\"http://localhost:8000/uploads/Evidence/\" + src}\r\n                    target=\"_blank\"\r\n                    download={index + 1}\r\n                  >\r\n                    Evidence {index + 1}\r\n                  </a>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div class=\"form-group mb-4\">\r\n              <label\r\n                class=\"button-attach ms-0\"\r\n                for=\"file\"\r\n                style={{ width: \"40%\" }}\r\n              >\r\n                <i class=\"bi bi-paperclip me-1\"></i>\r\n                Add new evidence\r\n              </label>\r\n              <input\r\n                accept=\"image/*, application/pdf, video/*\"\r\n                id=\"file\"\r\n                type=\"file\"\r\n                name=\"file\"\r\n                multiple\r\n                onChange={updateList}\r\n              ></input>\r\n              {isFilePicked ? (\r\n                <div id=\"fileList\">\r\n                  <ul class=\"py-2 mb-0\">\r\n                    {selectedFiles.map((k, index) => (\r\n                      <li class=\"d-flex justify-content-between align-items-center border rounded-3 border-3 border-light bg-white mt-2 ps-2\">\r\n                        {k.name}\r\n                        <button\r\n                          class=\"btn btn-light\"\r\n                          onClick={(e) => handleCrossButton(e, index)}\r\n                        >\r\n                          {\" \"}\r\n                          x{\" \"}\r\n                        </button>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              ) : (\r\n                <p class=\"d-none\">Select a file to show details</p>\r\n              )}\r\n              <span class={\"mb-2 text-danger d-\" + evidenceErrorClass}>\r\n                Please attach evidence(s)\r\n              </span>\r\n            </div>\r\n            <div className=\"form-group d-flex flex-column mb-4\">\r\n              <div className=\"col-12\">\r\n                <AsyncSelect\r\n                  loadOptions={fetchReviewerData}\r\n                  isDisabled\r\n                  value={reviewerOption}\r\n                  placeholder={\r\n                    <div style={{ color: \"grey\" }}>\r\n                      Choose Reviewer(only one)\r\n                    </div>\r\n                  }\r\n                  components={{\r\n                    DropdownIndicator: () => null, // Remove dropdown icon\r\n                    IndicatorSeparator: () => null, // Remove separator\r\n                  }}\r\n                  onChange={handleReviewerOnChange}\r\n                  onBlur={(e) => {\r\n                    setOpenCompReviewerMenu(false);\r\n                  }}\r\n                  onInputChange={(e, { action }) => {\r\n                    if (e.length === 0) {\r\n                      setOpenCompReviewerMenu(false);\r\n                      return;\r\n                    }\r\n                    if (action === \"input-change\") {\r\n                      setOpenCompReviewerMenu(true);\r\n                    }\r\n                  }}\r\n                  menuIsOpen={openCompReviewerMenu}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"d-block\">\r\n              <button type=\"submit\" class=\"btn btn-primary w-100 fw-bold\">\r\n                Edit Complaint\r\n              </button>\r\n            </div>\r\n          </form>\r\n          <div\r\n            class=\"modal fade\"\r\n            data-bs-backdrop=\"static\"\r\n            data-bs-keyboard=\"false\"\r\n            id=\"exampleModal\"\r\n            tabindex=\"-1\"\r\n            aria-labelledby=\"exampleModalLabel\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <div class=\"modal-dialog modal-dialog-centered\">\r\n              <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                  <h5 class=\"modal-title\" id=\"exampleModalLabel\">\r\n                    Complaint Edited Successfully!\r\n                  </h5>\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"btn-close\"\r\n                    data-bs-dismiss=\"modal\"\r\n                    aria-label=\"Close\"\r\n                  ></button>\r\n                </div>\r\n                <div class=\"modal-body\">Click OK to continue</div>\r\n                <div class=\"modal-footer\">\r\n                  <a className=\"btn btn-primary\" href=\"/\">\r\n                    OK\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EditComplaint;\r\n"]},"metadata":{},"sourceType":"module"}